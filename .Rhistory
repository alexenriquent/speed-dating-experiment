confusion <- confusion.matrix(prediction, truth)
rpart.analysis(rpart.pruned)
confusion.analysis(confusion)
rpart.analysis <- function(rpart) {
cat('\n')
print(rpart)
}
rpart.analysis(rpart.pruned)
confusion.analysis(confusion)
rpart.analysis <- function(rpart) {
cat('\n')
print(rpart)
cat('\n')
}
confusion.analysis <- function(matrix) {
tp <- matrix[1, 1]
fn <- matrix[1, 2]
fp <- matrix[2, 1]
tn <- matrix[2, 2]
accuracy <- (tp + tn) / (tp + tn + fp + fn)
precision <- tp / (tp + fp)
recall <- tp / (tp + fn)
f_measure <- (2 * recall * precision) / (recall + precision)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t", accuracy,
"\nPrecision:\t", precision,
"\nRecall:\t\t", recall,
"\nF-measure:\t", f_measure, "\n"))
}
rpart.analysis <- function(rpart) {
cat('\n')
print(rpart)
cat('\n')
}
rpart.analysis(rpart.pruned)
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
tp <- matrix[1, 1]
fn <- matrix[1, 2]
fp <- matrix[2, 1]
tn <- matrix[2, 2]
accuracy <- (tp + tn) / (tp + tn + fp + fn)
precision <- tp / (tp + fp)
recall <- tp / (tp + fn)
f_measure <- (2 * recall * precision) / (recall + precision)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t", accuracy,
"\nPrecision:\t", precision,
"\nRecall:\t\t", recall,
"\nF-measure:\t", f_measure, '\n'))
}
confusion.analysis(confusion)
rpart.analysis(rpart.pruned)
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t", ACC,
"\nSensitivity:\t\t", TPR,
"\nSpecificity:\t", TNR,
"\nFall-out:\t", FPR,
"\nMiss rate:\t", FNR,
"\nPrecision:\t", PPV,
"\nNegative predictive value:\t", NPV,
"\nFalse discovery rate:\t", FDR,
"\nF-measure:\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t", ACC,
"\nSensitivity:\t\t", TPR,
"\nSpecificity:\t", TNR,
"\nFall-out:\t", FPR,
"\nMiss rate:\t", FNR,
"\nPrecision/Positive predictive value:\t", PPV,
"\nNegative predictive value:\t", NPV,
"\nFalse discovery rate:\t", FDR,
"\nF-measure:\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t", ACC,
"\nSensitivity/True positive rate (TPR):\t", TPR,
"\nSpecificity/True negative rate (TNR):\t", TNR,
"\nFall-out/False positive rate (FPR):\t", FPR,
"\nMiss rate/False negative rate (FNR):\t", FNR,
"\nPrecision/Positive predictive value (PPV):\t", PPV,
"\nNegative predictive value (NPV):\t", NPV,
"\nFalse discovery rate (FDR):\t", FDR,
"\nF-measure:\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t", ACC,
"\nSensitivity:\t\t", TPR,
"\nSpecificity:\t\t", TNR,
"\nFall-out:\t\t", FPR,
"\nMiss rate:\t\t", FNR,
"\nPrecision:\t\t", PPV,
"\nNegative predictive value (NPV):\t", NPV,
"\nFalse discovery rate (FDR):\t", FDR,
"\nF-measure:\t\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t", ACC,
"\nSensitivity:\t\t", TPR,
"\nSpecificity:\t\t", TNR,
"\nFall-out:\t\t", FPR,
"\nMiss rate:\t\t", FNR,
"\nPrecision:\t\t", PPV,
"\nNegative predictive value:\t", NPV,
"\nFalse discovery rate:\t", FDR,
"\nF-measure:\t\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t", ACC,
"\nSensitivity:\t\t", TPR,
"\nSpecificity:\t\t", TNR,
"\nFall-out:\t\t", FPR,
"\nMiss rate:\t\t", FNR,
"\nPrecision:\t\t", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t", FDR,
"\nF-measure:\t\t", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t  ", ACC,
"\nSensitivity:\t\t  ", TPR,
"\nSpecificity:\t\t  ", TNR,
"\nFall-out:\t\t  ", FPR,
"\nMiss rate:\t\t  ", FNR,
"\nPrecision:\t\t  ", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t  ", FDR,
"\nF-measure:\t\t  ", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t   ", ACC,
"\nSensitivity:\t\t   ", TPR,
"\nSpecificity:\t\t   ", TNR,
"\nFall-out:\t\t   ", FPR,
"\nMiss rate:\t\t   ", FNR,
"\nPrecision:\t\t   ", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t   ", FDR,
"\nF-measure:\t\t   ", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t   ", ACC,
"\nSensitivity/Recall:\t\t   ", TPR,
"\nSpecificity:\t\t   ", TNR,
"\nFall-out:\t\t   ", FPR,
"\nMiss rate:\t\t   ", FNR,
"\nPrecision:\t\t   ", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t   ", FDR,
"\nF-measure:\t\t   ", F1, '\n'))
}
confusion.analysis(confusion)
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t   ", ACC,
"\nSensitivity/Recall:\t   ", TPR,
"\nSpecificity:\t\t   ", TNR,
"\nFall-out:\t\t   ", FPR,
"\nMiss rate:\t\t   ", FNR,
"\nPrecision:\t\t   ", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t   ", FDR,
"\nF-measure:\t\t   ", F1, '\n'))
}
confusion.analysis(confusion)
confusion.matrix <- function(prediction, truth) {
xtab <- (table(prediction, truth))
confusion <- matrix(rev(as.vector(xtab)), ncol = 2, byrow = TRUE)
colnames(confusion) <- c("Pred:yes", "Pred:no")
rownames(confusion) <- c("Actual:yes", "Actual:no")
confusion <- as.table(confusion)
}
confusion.analysis <- function(matrix) {
TP <- matrix[1, 1]
FN <- matrix[1, 2]
FP <- matrix[2, 1]
TN <- matrix[2, 2]
ACC <- (TP + TN) / (TP + TN + FP + FN)
TPR <- TP / (TP + FN)
TNR <- TN / (FP + TN)
FPR <- FP / (FP + TN)
FNR <- FN / (FN + TP)
PPV <- TP / (TP + FP)
NPV <- TN / (TN + FN)
FDR <- FP / (FP + TP)
F1 <- (2 * TPR * PPV) / (TPR + PPV)
cat('\n')
print(matrix)
cat(paste("\nAccuracy:\t\t   ", ACC,
"\nSensitivity/Recall:\t   ", TPR,
"\nSpecificity:\t\t   ", TNR,
"\nFall-out:\t\t   ", FPR,
"\nMiss rate:\t\t   ", FNR,
"\nPrecision:\t\t   ", PPV,
"\nNegative predictive value: ", NPV,
"\nFalse discovery rate:\t   ", FDR,
"\nF-measure:\t\t   ", F1, '\n'))
}
rpart.analysis <- function(rpart) {
cat('\n')
print(rpart)
cat('\n')
}
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
male <- data[data$gender == 1, ]
male.train <- male[1001:nrow(male), ]
male.test <- male[1:1000, ]
male.tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
male.rpart <- rpart(male.tree, data = male.train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
male.rpart.pruned <- rpart(male.tree, data = male.train, method = "class")
male.prediction <- predict(male.rpart.pruned, male.test, type = "class")
male.truth <- male.test$dec_o
male.roc <- prediction(predict(male.rpart.pruned, newdata = male.test, type = "prob")[, 2], male.test$dec_o)
plot(performance(male.roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
male.rparty <- as.party(male.rpart.pruned)
plot(male.rparty, type = "simple")
male.confusion <- confusion.matrix(male.prediction, male.truth)
male.confusion
rpart.analysis(male.rpart.pruned)
confusion.analysis(male.confusion)
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
female <- data[data$gender == 0, ]
female.train <- female[1001:nrow(female), ]
female.test <- female[1:1000, ]
female.tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
female.rpart <- rpart(female.tree, data = female.train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
female.rpart.pruned <- rpart(female.tree, data = female.train, method = "class")
female.prediction <- predict(female.rpart.pruned, female.test, type = "class")
female.truth <- female.test$dec_o
female.roc <- prediction(predict(female.rpart.pruned, newdata = female.test, type = "prob")[, 2], female.test$dec_o)
plot(performance(female.roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
female.rparty <- as.party(female.rpart.pruned)
plot(female.rparty, type = "simple")
female.confusion <- confusion.matrix(female.prediction, female.truth)
female.confusion
rpart.analysis(male.rpart.pruned)
confusion.analysis(male.confusion)
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
female <- data[data$gender == 0, ]
female.train <- female[1001:nrow(female), ]
female.test <- female[1:1000, ]
female.tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
female.rpart <- rpart(female.tree, data = female.train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
female.rpart.pruned <- rpart(female.tree, data = female.train, method = "class")
female.prediction <- predict(female.rpart.pruned, female.test, type = "class")
female.truth <- female.test$dec_o
female.roc <- prediction(predict(female.rpart.pruned, newdata = female.test, type = "prob")[, 2], female.test$dec_o)
plot(performance(female.roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
female.rparty <- as.party(female.rpart.pruned)
plot(female.rparty, type = "simple")
female.confusion <- confusion.matrix(female.prediction, female.truth)
female.confusion
rpart.analysis(female.rpart.pruned)
confusion.analysis(female.confusion)
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
train <- data[2001:nrow(data), ]
test <- data[1:2000, ]
tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
rpart <- rpart(tree, data = train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
rpart.pruned <- rpart(tree, data = train, method = "class")
prediction <- predict(rpart.pruned, test, type = "class")
truth <- test$dec_o
roc <- prediction(predict(rpart.pruned, newdata = test, type = "prob")[, 2], test$dec_o)
plot(performance(roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
rparty <- as.party(rpart.pruned)
plot(rparty, type = "simple")
confusion <- confusion.matrix(prediction, truth)
rpart.analysis(rpart.pruned)
confusion.analysis(confusion)
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
male <- data[data$gender == 1, ]
male.train <- male[1001:nrow(male), ]
male.test <- male[1:1000, ]
male.tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
male.rpart <- rpart(male.tree, data = male.train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
male.rpart.pruned <- rpart(male.tree, data = male.train, method = "class")
male.prediction <- predict(male.rpart.pruned, male.test, type = "class")
male.truth <- male.test$dec_o
male.roc <- prediction(predict(male.rpart.pruned, newdata = male.test, type = "prob")[, 2], male.test$dec_o)
plot(performance(male.roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
male.rparty <- as.party(male.rpart.pruned)
plot(male.rparty, type = "simple")
male.confusion <- confusion.matrix(male.prediction, male.truth)
male.confusion
rpart.analysis(male.rpart.pruned)
confusion.analysis(male.confusion)
library(rpart)
library(rpart.plot)
library(partykit)
library(ROCR)
source("R/analysis.R")
source("R/utilities.R")
data <- read.csv("data/dataset.csv", header = TRUE, stringsAsFactors = FALSE)
data <- data.format(data)
female <- data[data$gender == 0, ]
female.train <- female[1001:nrow(female), ]
female.test <- female[1:1000, ]
female.tree <- dec_o ~ attr_o + intel_o + sinc_o + fun_o + amb_o + shar_o
female.rpart <- rpart(female.tree, data = female.train, method = "class", control = rpart.control(cp = 0, maxdepth = 4))
female.rpart.pruned <- rpart(female.tree, data = female.train, method = "class")
female.prediction <- predict(female.rpart.pruned, female.test, type = "class")
female.truth <- female.test$dec_o
female.roc <- prediction(predict(female.rpart.pruned, newdata = female.test, type = "prob")[, 2], female.test$dec_o)
plot(performance(female.roc, "tpr", "fpr"), colorize = TRUE)
abline(0, 1, lty = 3)
female.rparty <- as.party(female.rpart.pruned)
plot(female.rparty, type = "simple")
female.confusion <- confusion.matrix(female.prediction, female.truth)
female.confusion
rpart.analysis(female.rpart.pruned)
confusion.analysis(female.confusion)
